pipeline World_bank_data {
// Pipline root to node
    World_bank_data_Extractor
        -> File_XLSX_Interpreter
        -> Figure_Sheet_Collector
        -> Change_Country_Code
        -> Change_GDP_And_Bond_attribute
        -> Range_data_for_P2
        -> Bond_Table_Interpreter
        -> Bond_Loader;


// Ranging data following the instructions
    Range_data_for_P2
        -> Data_Interpreter_for_GDP_column
        -> GDP_value_Loader_Per_capita;

// World Bank data extracting through the given link
    block World_bank_data_Extractor oftype HttpExtractor {
        url: "https://thedocs.worldbank.org/en/doc/7d852628d96b9411d43e5d36d5dff941-0050062022/original/Graphs-Chapter-5-02082022.xlsx";
    }

    block File_XLSX_Interpreter oftype XLSXInterpreter { }
// Specification of sheet picking 
    block Figure_Sheet_Collector oftype SheetPicker {
        sheetName: 'Figure S5.1.2';
    }
// Country code changing through cell writing
    block Change_Country_Code oftype CellWriter {
        at: range P2:P2;
        write: [
            "Country Code",
        ];
    }
// Chnaging in gdp and bond issunce share value
    block Change_GDP_And_Bond_attribute oftype CellWriter {
        at: range R2:S2;
        write: [
            "GDP per Capita",
            "Bond Issuance Share"
        ];
    }
// Specific data selction for P2: S45
    block Range_data_for_P2 oftype CellRangeSelector {
        select: range P2:S45;
    }
// Table interpreting With ranging to defines value "ISO_3166_1" and for Bond Issuance Share "RangeZeroToOne"

    block Bond_Table_Interpreter oftype TableInterpreter {
        header: true;
        columns: [
            "Country Code" oftype ISO_3166_1,
            "Bond Issuance Share" oftype RangeZeroToOne
        ];
    }
// Creation of Sqlite file
    block Bond_Loader oftype SQLiteLoader {

        table: "bondIssuance";
        file: "country-stats.sqlite";
    }

// Defines the format of two column

    block Data_Interpreter_for_GDP_column oftype TableInterpreter {
        header: true;
        columns: [
            "Country Code" oftype ISO_3166_1,
            "GDP per Capita" oftype positiveDecimal
        ];
    }
// Gdp block for per capita 
    block GDP_value_Loader_Per_capita oftype SQLiteLoader {
        table: "gdpPerCapita";
        file: "country-stats.sqlite";
    }

}
// Value type to avoid error 
valuetype ISO_3166_1 oftype text {
    constraints: [
        ISO_3166_1_Validator
    ];
}
// Regexconstraint to a value where it can search for A-Z value and other denominators
constraint ISO_3166_1_Validator oftype RegexConstraint {
    regex: /^[A-Z]{3}$/;
}
// Positive value validations
valuetype positiveDecimal oftype decimal {
    constraints: [
        positivevalue
    ];
}
constraint positivevalue on decimal: value > 0;
// Define the value betwwen zero and one
valuetype RangeZeroToOne oftype decimal {
    constraints: [
        BondIssuanceShareConstraint
    ]
}
// used to validate the data and enforce that the "Bond Issuance Share" values are correct and within the expected range
constraint BondIssuanceShareConstraint on decimal: value >= 0 and value <= 1;
